<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BD TV - Final Pro</title>
    
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

    <style>
        :root { --accent: #00f2fe; --bg: #050505; }
        body { background: var(--bg); color: #fff; font-family: sans-serif; margin: 0; overflow: hidden; }

        /* ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶™‡ßç‡¶≤‡ßá‡ßü‡¶æ‡¶∞ */
        #videoContainer { width: 100vw; height: 100vh; background: #000; position: fixed; z-index: 1; }
        video { width: 100%; height: 100%; object-fit: contain; }

        /* ‡¶ü‡¶ø‡¶≠‡¶ø ‡¶ì‡¶≠‡¶æ‡¶∞‡¶≤‡ßá (ID & QR) */
        .tv-overlay {
            position: fixed; top: 20px; right: 20px; z-index: 100;
            background: rgba(0,0,0,0.8); padding: 12px; border-radius: 15px;
            border: 1px solid var(--accent); text-align: center; backdrop-filter: blur(10px);
        }
        .qr-box img { width: 100px; height: 100px; background: #fff; border-radius: 8px; padding: 5px; }

        /* ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø */
        .bottom-info {
            position: fixed; bottom: 0; width: 100%; z-index: 50;
            background: linear-gradient(transparent, rgba(0,0,0,0.9));
            padding: 40px; transition: 0.5s;
        }
        .channel-name { font-size: 28px; font-weight: bold; margin: 0; color: var(--accent); }

        /* ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶∞‡¶ø‡¶Æ‡ßã‡¶ü ‡¶Æ‡ßã‡¶° (‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø) */
        #mobileUI {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #111; z-index: 999; flex-direction: column; align-items: center; justify-content: center;
        }
        .remote-btn {
            width: 200px; padding: 20px; margin: 10px; font-size: 20px;
            background: var(--accent); border: none; border-radius: 50px; color: #000; font-weight: bold;
        }
    </style>
</head>
<body>

    <div id="videoContainer">
        <video id="mainPlayer" autoplay muted playsinline controls></video>
    </div>

    <div class="tv-overlay" id="tvOverlay">
        <div class="qr-box"><img id="qrImg" src="" alt="QR"></div>
        <div style="font-size: 12px; margin-top: 5px;" id="displayID">‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</div>
    </div>

    <div class="bottom-info" id="bottomUI">
        <p id="playingNow" class="channel-name">‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
    </div>

    <div id="mobileUI">
        <h2 style="color:var(--accent)">SMART REMOTE</h2>
        <button class="remote-btn" onclick="control('next')">‡¶™‡¶∞‡ßá‡¶∞ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‚ñ∂</button>
        <button class="remote-btn" onclick="control('prev')">‚óÄ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</button>
        <button class="remote-btn" style="background:#444; color:#fff" onclick="location.reload()">üîÑ ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ü‡¶ø‡¶≠‡¶ø</button>
    </div>

<script>
    const m3uUrl = "https://raw.githubusercontent.com/soheltanver85-a11y/Live-tv/refs/heads/main/Live%20tv";
    const video = document.getElementById('mainPlayer');
    let channels = [];
    let currentIdx = 0;
    let hls = null;

    // ‡ßß. ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶°‡¶ø‡¶ü‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ (‡¶è‡¶ü‡¶ø ‡¶ï‡¶ø ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶æ ‡¶ü‡¶ø‡¶≠‡¶ø?)
    const urlParams = new URLSearchParams(window.location.search);
    const isRemote = urlParams.get('mode') === 'remote';

    async function init() {
        try {
            const res = await fetch(m3uUrl);
            const data = await res.text();
            const lines = data.split('\n');
            for (let i = 0; i < lines.length; i++) {
                if (lines[i].includes('#EXTINF')) {
                    channels.push({ name: lines[i].split(',')[1].trim(), url: lines[i+1].trim() });
                }
            }

            if (isRemote) {
                // ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶Æ‡ßã‡¶°
                document.getElementById('mobileUI').style.display = 'flex';
                document.getElementById('videoContainer').style.display = 'none';
                document.getElementById('tvOverlay').style.display = 'none';
            } else {
                // ‡¶ü‡¶ø‡¶≠‡¶ø ‡¶Æ‡ßã‡¶°
                setupTV();
                play(0);
            }
        } catch (e) {
            document.getElementById('playingNow').innerText = "‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡ßá ‡¶®‡¶æ!";
        }
    }

    function setupTV() {
        // QR Code ‡¶§‡ßà‡¶∞‡¶ø
        const currentLink = window.location.href.split('?')[0] + "?mode=remote";
        document.getElementById('qrImg').src = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(currentLink)}`;
        
        // ‡¶∞‡¶ø‡¶Æ‡ßã‡¶ü ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶∂‡ßã‡¶®‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø LocalStorage (‡¶è‡¶ï‡¶á ‡¶®‡ßá‡¶ü‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶ï‡ßá ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá)
        window.addEventListener('storage', (e) => {
            if (e.key === 'remote_cmd') {
                if (e.newValue === 'next') changeChannel(1);
                if (e.newValue === 'prev') changeChannel(-1);
            }
        });
    }

    function control(cmd) {
        // ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤‡ßá ‡¶ö‡¶æ‡¶™ ‡¶¶‡¶ø‡¶≤‡ßá ‡¶ï‡¶Æ‡¶æ‡¶®‡ßç‡¶° ‡¶∏‡ßá‡¶≠ ‡¶π‡¶¨‡ßá
        localStorage.setItem('remote_cmd', cmd);
        localStorage.setItem('remote_time', Date.now());
        alert("‡¶ï‡¶Æ‡¶æ‡¶®‡ßç‡¶° ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡ßü‡ßá‡¶õ‡ßá: " + cmd + "\n(‡¶è‡¶ï‡¶á ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá ‡¶ü‡¶ø‡¶≠‡¶ø ‡¶ñ‡ßã‡¶≤‡¶æ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶¨‡ßá)");
    }

    function play(index) {
        if (!channels[index]) return;
        currentIdx = index;
        document.getElementById('playingNow').innerText = channels[currentIdx].name;

        if (hls) hls.destroy();
        if (Hls.isSupported()) {
            hls = new Hls();
            hls.loadSource(channels[currentIdx].url);
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
        } else {
            video.src = channels[currentIdx].url;
        }
    }

    function changeChannel(dir) {
        currentIdx = (currentIdx + dir + channels.length) % channels.length;
        play(currentIdx);
    }

    // ‡¶ï‡¶ø‡¶¨‡ßã‡¶∞‡ßç‡¶°/‡¶∞‡¶ø‡¶Æ‡ßã‡¶ü ‡¶è‡¶∞‡ßã ‡¶¨‡¶æ‡¶ü‡¶® ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü
    document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight') changeChannel(1);
        if (e.key === 'ArrowLeft') changeChannel(-1);
    });

    init();
</script>
</body>
</html>
