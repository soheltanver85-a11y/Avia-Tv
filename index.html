<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BD LIVE TV - Pro Sound & Control</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.12"></script>
    <style>
        :root { --accent: #00f2fe; --bg: #050505; }
        body { background: var(--bg); color: #fff; font-family: sans-serif; margin: 0; overflow: hidden; }

        #videoContainer { width: 100vw; height: 100vh; position: fixed; top: 0; z-index: 1; background: #000; }
        video { width: 100%; height: 100%; object-fit: contain; }

        /* ‡¶∏‡¶æ‡¶â‡¶®‡ßç‡¶° ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶á‡¶®‡ßç‡¶°‡¶ø‡¶ï‡ßá‡¶ü‡¶∞ */
        #volumeUI {
            position: fixed; top: 40px; left: 40px; z-index: 1000;
            background: rgba(0,0,0,0.7); padding: 15px; border-radius: 10px;
            border-left: 5px solid var(--accent); display: none;
        }

        /* ‡¶Ö‡¶ü‡ßã-‡¶Ü‡¶®‡¶Æ‡¶ø‡¶â‡¶ü ‡¶¨‡¶æ‡¶ü‡¶® (‡¶™‡¶õ‡¶®‡ßç‡¶¶ ‡¶®‡¶æ ‡¶π‡¶≤‡ßá ‡¶è‡¶ü‡¶ø ‡¶∏‡¶∞‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü) */
        #soundToggle {
            position: fixed; bottom: 150px; right: 40px; z-index: 200;
            background: var(--accent); color: #000; border: none; padding: 15px;
            border-radius: 50%; cursor: pointer; font-size: 20px; box-shadow: 0 0 20px rgba(0,242,254,0.5);
        }

        .overlay {
            position: fixed; bottom: 0; width: 100%; z-index: 100;
            background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
            padding: 20px 0; transition: 0.5s;
        }
        .tray { display: flex; gap: 15px; overflow-x: auto; padding: 10px 40px; }
        .tray::-webkit-scrollbar { display: none; }
        .card {
            min-width: 160px; height: 90px; background: rgba(255,255,255,0.1);
            border-radius: 12px; display: flex; align-items: center; justify-content: center;
            cursor: pointer; outline: none; border: 2px solid transparent;
        }
        .card:focus { border-color: var(--accent); transform: scale(1.1); background: rgba(0,242,254,0.1); }
        .hidden { opacity: 0; transform: translateY(100%); }
    </style>
</head>
<body>

    <div id="volumeUI">üîä Volume: <span id="volLevel">100</span>%</div>
    <button id="soundToggle" onclick="toggleMute()">üîä</button>

    <div id="videoContainer">
        <video id="mainPlayer" autoplay playsinline></video>
    </div>

    <div class="overlay" id="ui">
        <div id="playingNow" style="margin-left: 45px; color: var(--accent); font-weight: bold;">‡¶≤‡ßã‡¶°‡¶ø‡¶Ç...</div>
        <div class="tray" id="tray"></div>
    </div>

<script>
    const m3uUrl = "https://raw.githubusercontent.com/soheltanver85-a11y/Live-tv/refs/heads/main/Live%20tv";
    const video = document.getElementById('mainPlayer');
    let channels = [];
    let currentIdx = 0;
    let hls = null;

    async function init() {
        try {
            const res = await fetch(m3uUrl);
            const data = await res.text();
            const lines = data.split('\n');
            for (let i = 0; i < lines.length; i++) {
                if (lines[i].includes('#EXTINF')) {
                    channels.push({ name: lines[i].split(',')[1].trim(), url: lines[i+1]?.trim() });
                }
            }
            render();
        } catch (e) { console.log("Error"); }
    }

    function render() {
        const tray = document.getElementById('tray');
        channels.forEach((ch, idx) => {
            const card = document.createElement('div');
            card.className = 'card';
            card.tabIndex = 0;
            card.innerText = ch.name;
            card.onclick = () => { currentIdx = idx; play(); };
            card.onkeydown = (e) => { if(e.key === 'Enter') { currentIdx = idx; play(); } };
            tray.appendChild(card);
        });
        if(channels.length > 0) play();
    }

    function play() {
        const ch = channels[currentIdx];
        document.getElementById('playingNow').innerText = "‡¶ö‡¶≤‡¶õ‡ßá: " + ch.name;
        
        if (hls) hls.destroy();
        if (Hls.isSupported()) {
            hls = new Hls();
            hls.loadSource(ch.url);
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED, () => {
                video.play().catch(() => {
                    video.muted = true; // ‡¶Ö‡¶ü‡ßã-‡¶™‡ßç‡¶≤‡ßá ‡¶¨‡ßç‡¶≤‡¶ï ‡¶π‡¶≤‡ßá ‡¶Æ‡¶ø‡¶â‡¶ü ‡¶ï‡¶∞‡ßá ‡¶ö‡¶æ‡¶≤‡¶æ‡¶¨‡ßá
                    video.play();
                    updateSoundIcon();
                });
            });
        }
        showUI();
    }

    function toggleMute() {
        video.muted = !video.muted;
        updateSoundIcon();
    }

    function updateSoundIcon() {
        const btn = document.getElementById('soundToggle');
        btn.innerText = video.muted ? "üîá" : "üîä";
        if(!video.muted) video.volume = 1.0;
    }

    function changeVolume(amount) {
        let newVol = video.volume + amount;
        if (newVol > 1) newVol = 1;
        if (newVol < 0) newVol = 0;
        video.volume = newVol;
        video.muted = false;
        
        const volUI = document.getElementById('volumeUI');
        document.getElementById('volLevel').innerText = Math.round(newVol * 100);
        volUI.style.display = 'block';
        updateSoundIcon();
        
        clearTimeout(window.volTimer);
        window.volTimer = setTimeout(() => volUI.style.display = 'none', 2000);
    }

    function showUI() {
        document.getElementById('ui').classList.remove('hidden');
        clearTimeout(window.uiTimer);
        window.uiTimer = setTimeout(() => {
            if (document.activeElement.className !== 'card') document.getElementById('ui').classList.add('hidden');
        }, 5000);
    }

    // ‡¶∞‡¶ø‡¶Æ‡ßã‡¶ü ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶≤‡¶ú‡¶ø‡¶ï
    document.addEventListener('keydown', (e) => {
        showUI();
        // ‡ßß. ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® (Left/Right)
        if (document.activeElement.tagName !== 'DIV' || !document.activeElement.classList.contains('card')) {
            if (e.key === 'ArrowRight') { currentIdx = (currentIdx + 1) % channels.length; play(); }
            if (e.key === 'ArrowLeft') { currentIdx = (currentIdx - 1 + channels.length) % channels.length; play(); }
        }
        
        // ‡ß®. ‡¶≠‡¶≤‡¶ø‡¶â‡¶Æ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ (Up/Down)
        if (e.key === 'ArrowUp') { e.preventDefault(); changeVolume(0.1); }
        if (e.key === 'ArrowDown') { e.preventDefault(); changeVolume(-0.1); }
    });

    init();
</script>
</body>
</html>
