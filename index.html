<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BD LIVE TV - Sound Fixed</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.12"></script>
    <style>
        :root { --accent: #00f2fe; --bg: #050505; }
        body { background: var(--bg); color: #fff; font-family: sans-serif; margin: 0; overflow: hidden; }

        /* ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶™‡ßç‡¶≤‡ßá‡ßü‡¶æ‡¶∞ */
        #videoContainer { width: 100vw; height: 100vh; position: fixed; top: 0; z-index: 1; background: #000; }
        video { width: 100%; height: 100%; object-fit: contain; }

        /* ‡¶Ü‡¶®‡¶Æ‡¶ø‡¶â‡¶ü ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® (‡¶Ø‡¶¶‡¶ø ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶® ‡¶π‡ßü) */
        #unmuteHint {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            z-index: 200; background: rgba(0,0,0,0.8); padding: 20px 40px;
            border-radius: 50px; border: 2px solid var(--accent);
            font-size: 20px; color: var(--accent); display: none; pointer-events: none;
        }

        /* ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü */
        .bottom-ui {
            position: fixed; bottom: 0; width: 100%; z-index: 100;
            background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
            padding: 20px 0; transition: 0.5s;
        }
        .tray { display: flex; gap: 15px; overflow-x: auto; padding: 10px 40px; scroll-behavior: smooth; }
        .tray::-webkit-scrollbar { display: none; }

        .tv-card {
            min-width: 160px; height: 90px; background: rgba(255,255,255,0.1);
            border-radius: 15px; display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.3s; border: 2px solid transparent; outline: none;
            font-weight: bold; text-align: center; backdrop-filter: blur(10px);
        }
        .tv-card:focus { border-color: var(--accent); transform: scale(1.1); background: rgba(0, 242, 254, 0.2); }
        
        #playingNow { margin-left: 45px; font-size: 1.2rem; color: var(--accent); margin-bottom: 5px; }
    </style>
</head>
<body>

    <div id="unmuteHint">‡¶∏‡¶æ‡¶â‡¶®‡ßç‡¶° ‡¶™‡ßá‡¶§‡ßá ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡¶æ‡¶ü‡¶® ‡¶ö‡¶æ‡¶™‡ßÅ‡¶® üîä</div>

    <div id="videoContainer">
        <video id="mainPlayer" autoplay playsinline></video>
    </div>

    <div class="bottom-ui" id="ui">
        <div id="playingNow">‡¶≤‡ßã‡¶°‡¶ø‡¶Ç...</div>
        <div class="tray" id="tray"></div>
    </div>

<script>
    const m3uUrl = "https://raw.githubusercontent.com/soheltanver85-a11y/Live-tv/refs/heads/main/Live%20tv";
    const video = document.getElementById('mainPlayer');
    let hls = null;
    let isMuted = true;

    // ‡ßß. ‡¶∏‡¶æ‡¶â‡¶®‡ßç‡¶° ‡¶è‡¶®‡¶æ‡¶¨‡¶≤ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    function enableSound() {
        if (isMuted) {
            video.muted = false;
            video.volume = 1.0;
            isMuted = false;
            document.getElementById('unmuteHint').style.display = 'none';
            console.log("Sound Enabled");
        }
    }

    // ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®‡ßá ‡¶∏‡¶æ‡¶â‡¶®‡ßç‡¶° ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶π‡¶¨‡ßá
    document.addEventListener('keydown', enableSound);
    document.addEventListener('click', enableSound);

    async function init() {
        try {
            const res = await fetch(m3uUrl);
            const data = await res.text();
            const lines = data.split('\n');
            const channels = [];
            
            for (let i = 0; i < lines.length; i++) {
                if (lines[i].includes('#EXTINF')) {
                    const name = lines[i].split(',')[1] || "Unnamed";
                    const url = lines[i+1]?.trim();
                    if(url && url.startsWith('http')) channels.push({ name, url });
                }
            }
            render(channels);
        } catch (e) { console.error("Data error"); }
    }

    function render(channels) {
        const tray = document.getElementById('tray');
        channels.forEach(ch => {
            const card = document.createElement('div');
            card.className = 'tv-card';
            card.tabIndex = 0;
            card.innerText = ch.name;
            card.onclick = () => play(ch.url, ch.name);
            card.onkeydown = (e) => { if(e.key === 'Enter') play(ch.url, ch.name); };
            tray.appendChild(card);
        });

        if(channels.length > 0) {
            play(channels[0].url, channels[0].name);
            // ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶§‡ßá ‡¶∏‡¶æ‡¶â‡¶®‡ßç‡¶° ‡¶¨‡¶®‡ßç‡¶ß ‡¶•‡¶æ‡¶ï‡ßá ‡¶§‡¶æ‡¶á ‡¶π‡¶ø‡¶®‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
            document.getElementById('unmuteHint').style.display = 'block';
            setTimeout(() => tray.firstChild.focus(), 1000);
        }
    }

    function play(url, name) {
        document.getElementById('playingNow').innerText = "‡¶ö‡¶≤‡¶õ‡ßá: " + name;
        
        // ‡¶™‡ßç‡¶≤‡ßá ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶∏‡¶æ‡¶â‡¶®‡ßç‡¶° ‡¶Ö‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ
        video.muted = false; 

        if (hls) hls.destroy();
        if (Hls.isSupported()) {
            hls = new Hls();
            hls.loadSource(url);
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED, () => {
                video.play().catch(() => {
                    // ‡¶Ø‡¶¶‡¶ø ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞ ‡¶¨‡ßç‡¶≤‡¶ï ‡¶ï‡¶∞‡ßá, ‡¶§‡¶¨‡ßá ‡¶Æ‡¶ø‡¶â‡¶ü ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶≤‡ßá ‡¶ï‡¶∞‡¶¨‡ßá
                    video.muted = true;
                    video.play();
                    isMuted = true;
                });
            });
        } else {
            video.src = url;
        }
    }

    init();
</script>
</body>
</html>
