<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sohel Live TV • ৯২+ বাংলা চ্যানেল</title>
  <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.15"></script>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Hind Siliguri',sans-serif;background:#0a0a1f;color:#e0e0ff;min-height:100vh;}
    header{background:linear-gradient(135deg,#1e0033,#330066);padding:1rem;text-align:center;box-shadow:0 4px 20px rgba(0,0,0,.7);}
    h1{font-size:2.3rem;color:#00ffff;text-shadow:0 0 15px #00ffffaa;}
    .container{max-width:1450px;margin:2rem auto;padding:0 1rem;display:grid;grid-template-columns:340px 1fr;gap:2rem;}
    .playlist{background:#111133;border-radius:14px;overflow:hidden;height:fit-content;position:sticky;top:1.5rem;}
    .playlist h2{background:#1a1a55;padding:1rem;font-size:1.4rem;border-bottom:3px solid #00ffff44;}
    .channel-list{max-height:75vh;overflow-y:auto;padding:1rem;}
    .channel{padding:1rem;margin:.6rem 0;background:#1c1c44;border-radius:12px;cursor:pointer;transition:all .3s;border-left:5px solid transparent;display:flex;align-items:center;}
    .channel:hover,.channel.active{background:#2a2a66;transform:translateX(8px);border-left:5px solid #00ffff;box-shadow:0 6px 20px rgba(0,255,255,.2);}
    .channel img{width:48px;height:48px;object-fit:cover;border-radius:8px;margin-right:1rem;}
    .channel span{font-size:1.1rem;}
    .player-area{background:#000;border-radius:14px;overflow:hidden;box-shadow:0 12px 50px rgba(0,0,0,.8);position:relative;}
    #videoPlayer{width:100%;aspect-ratio:16/9;background:#000;}
    .now-playing{padding:1.2rem;background:#1a0033;text-align:center;font-size:1.4rem;color:#00ffff;border-top:2px solid #00ffff44;}
    .loading{position:absolute;inset:0;background:rgba(0,0,0,.75);display:flex;align-items:center;justify-content:center;color:#00ffff;font-size:2rem;z-index:10;}
    @media (max-width:950px){.container{grid-template-columns:1fr;}.playlist{position:static;}}
  </style>
</head>
<body>

<header>
  <h1>Sohel Live TV • বাংলা চ্যানেলস</h1>
</header>

<div class="container">
  <div class="playlist">
    <h2>সকল চ্যানেল (৯২+)</h2>
    <div class="channel-list" id="channelList">
      <div class="loading" style="position:relative;height:200px;">চ্যানেল লোড হচ্ছে...</div>
    </div>
  </div>

  <div class="player-area">
    <div style="position:relative;">
      <video id="videoPlayer" controls autoplay playsinline muted></video>
      <div class="loading" id="playerLoading">চ্যানেল চালু হচ্ছে... অপেক্ষা করুন</div>
    </div>
    <div class="now-playing" id="nowPlaying">চ্যানেল সিলেক্ট করুন</div>
  </div>
</div>

<script>
const M3U_URL = "https://raw.githubusercontent.com/soheltanver85-a11y/Live-tv/refs/heads/main/Live%20tv";

const video = document.getElementById('videoPlayer');
const hls = Hls.isSupported() ? new Hls() : null;

async function loadPlaylist() {
  try {
    const res = await fetch(M3U_URL);
    const text = await res.text();
    const lines = text.split('\n').map(l => l.trim()).filter(Boolean);
    
    const channels = [];
    let current = null;

    for (let line of lines) {
      if (line.startsWith('#EXTINF:')) {
        const info = line.match(/#EXTINF:.*,(.*)/)?.[1] || 'অজানা চ্যানেল';
        const logo = line.match(/tvg-logo="([^"]+)"/)?.[1] || '';
        const group = line.match(/group-title="([^"]+)"/)?.[1] || '';
        
        current = { name: info.trim(), logo, group };
      } 
      else if (line.startsWith('http') && current) {
        current.url = line;
        channels.push(current);
        current = null;
      }
    }

    renderChannels(channels);
  } catch (err) {
    console.error(err);
    document.getElementById('channelList').innerHTML = 
      '<p style="color:#ff4444;padding:2rem;text-align:center;">চ্যানেল লিস্ট লোড করতে সমস্যা হয়েছে। পরে চেষ্টা করুন।</p>';
  }
}

function renderChannels(channels) {
  const list = document.getElementById('channelList');
  list.innerHTML = '';

  channels.forEach((ch, i) => {
    const div = document.createElement('div');
    div.className = 'channel';
    div.innerHTML = `
      \( {ch.logo ? `<img src=" \){ch.logo}" alt="${ch.name}" onerror="this.src='https://via.placeholder.com/48?text=TV'">` : ''}
      <span>${ch.name}</span>
    `;
    
    div.onclick = () => playThis(ch.url, ch.name, div);
    
    // প্রথম চ্যানেল অটো লোড (১.৫ সেকেন্ড পর)
    if (i === 0) setTimeout(() => div.click(), 1500);
    
    list.appendChild(div);
  });
}

function playThis(url, name, element) {
  document.querySelectorAll('.channel').forEach(el => el.classList.remove('active'));
  element.classList.add('active');
  
  document.getElementById('nowPlaying').textContent = name;
  document.getElementById('playerLoading').style.display = 'flex';
  
  if (hls) {
    hls.loadSource(url);
    hls.attachMedia(video);
    hls.on(Hls.Events.MANIFEST_PARSED, () => {
      video.play().catch(e => console.log("Autoplay blocked", e));
      document.getElementById('playerLoading').style.display = 'none';
    });
    hls.on(Hls.Events.ERROR, (event, data) => {
      if (data.fatal) {
        console.error("HLS Error:", data);
        document.getElementById('playerLoading').innerHTML = 'চ্যানেল চালু করা যায়নি • অন্য চ্যানেল চেষ্টা করুন';
      }
    });
  } 
  else if (video.canPlayType('application/vnd.apple.mpegurl')) {
    video.src = url;
    video.addEventListener('loadedmetadata', () => {
      video.play().catch(()=>{});
      document.getElementById('playerLoading').style.display = 'none';
    });
  } 
  else {
    alert("আপনার ব্রাউজারে লাইভ টিভি সাপোর্ট নেই। Chrome / Edge / Firefox ব্যবহার করুন।");
  }
}

loadPlaylist();
</script>
</body>
</html>
