<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BD LIVE TV - Optimized</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        :root { --accent: #00f2fe; --bg: #000; }
        body { background: var(--bg); color: #fff; font-family: sans-serif; margin: 0; overflow: hidden; }

        /* ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶™‡ßç‡¶≤‡ßá‡ßü‡¶æ‡¶∞ ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ - ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶™‡¶∞‡¶ø‡¶∑‡ßç‡¶ï‡¶æ‡¶∞ */
        #videoContainer { width: 100vw; height: 100vh; position: fixed; top: 0; left: 0; z-index: 1; }
        video { width: 100%; height: 100%; object-fit: contain; }

        /* ‡¶∏‡¶æ‡¶á‡¶° ‡¶ü‡ßÅ‡¶≤‡¶¨‡¶æ‡¶∞ - ‡¶ï‡¶ø‡¶â‡¶Ü‡¶∞ ‡¶ï‡ßã‡¶° ‡¶è‡¶¨‡¶Ç ‡¶¨‡¶æ‡¶ü‡¶®‡¶ó‡ßÅ‡¶≤‡ßã ‡¶°‡¶æ‡¶® ‡¶¶‡¶ø‡¶ï‡ßá ‡¶∏‡¶æ‡¶ú‡¶æ‡¶®‡ßã */
        .side-toolbar {
            position: fixed; top: 20px; right: 20px; z-index: 100;
            display: flex; flex-direction: column; gap: 15px; align-items: flex-end;
            transition: opacity 0.5s;
        }

        .tool-item {
            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px;
            padding: 10px; cursor: pointer; transition: 0.3s; color: #fff;
            display: flex; align-items: center; gap: 10px; text-decoration: none;
        }

        .tool-item:focus, .tool-item:hover {
            background: var(--accent); color: #000; transform: scale(1.1);
        }

        /* ‡¶ï‡¶ø‡¶â‡¶Ü‡¶∞ ‡¶ï‡ßã‡¶° ‡¶Ø‡¶ñ‡¶® ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶§‡¶ñ‡¶® ‡¶¨‡ßú ‡¶π‡¶¨‡ßá */
        .qr-section { text-align: center; }
        .qr-section img { 
            width: 50px; border-radius: 5px; transition: 0.3s; 
            border: 2px solid #fff;
        }
        .tool-item:focus img { width: 120px; } /* ‡¶´‡ßã‡¶ï‡¶æ‡¶∏ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶ï‡¶ø‡¶â‡¶Ü‡¶∞ ‡¶¨‡ßú ‡¶π‡¶¨‡ßá */

        /* ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü */
        .bottom-overlay {
            position: fixed; bottom: 0; width: 100%; z-index: 50;
            background: linear-gradient(transparent, rgba(0,0,0,0.9));
            padding: 20px; transition: opacity 0.5s;
        }

        .channel-tray { display: flex; gap: 15px; overflow-x: auto; padding: 10px; }
        .channel-tray::-webkit-scrollbar { display: none; }

        .tv-card {
            min-width: 150px; height: 80px; background: rgba(255,255,255,0.1);
            border-radius: 12px; display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.3s; border: 2px solid transparent; outline: none;
        }
        .tv-card:focus { border-color: var(--accent); transform: scale(1.1); background: rgba(0, 242, 254, 0.2); }

        .status-msg { position: fixed; top: 20px; left: 20px; z-index: 100; color: var(--accent); font-weight: bold; }
    </style>
</head>
<body>

    <div class="status-msg" id="status">‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶∞‡ßá‡¶°‡¶ø...</div>

    <div id="videoContainer">
        <video id="mainPlayer" controls autoplay></video>
    </div>

    <div class="side-toolbar" id="sideToolbar">
        <button class="tool-item" id="multiViewBtn">üî≥ ‡¶Æ‡¶æ‡¶≤‡ßç‡¶ü‡¶ø-‡¶≠‡¶ø‡¶â</button>
        <button class="tool-item" onclick="setTimer()">‚è∞ ‡¶∏‡ßç‡¶≤‡¶ø‡¶™ ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞</button>
        <div class="tool-item qr-section" tabindex="0">
            <span>üì± ‡¶∞‡¶ø‡¶Æ‡ßã‡¶ü</span>
            <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://soheltanver85-a11y.github.io/BD-LIVE-TV/" alt="QR">
        </div>
    </div>

    <div class="bottom-overlay" id="bottomUI">
        <div id="playingNow" style="margin-left: 20px; font-size: 1.2rem; margin-bottom: 10px;">‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</div>
        <div class="channel-tray" id="tray"></div>
    </div>

<script>
    const m3uUrl = "https://raw.githubusercontent.com/soheltanver85-a11y/Live-tv/refs/heads/main/Live%20tv";
    const video = document.getElementById('mainPlayer');
    const tray = document.getElementById('tray');
    let channels = [];
    let uiTimer;

    // ‡¶á‡¶â‡¶Ü‡¶á ‡¶Ö‡¶ü‡ßã-‡¶π‡¶æ‡¶á‡¶° ‡¶≤‡¶ú‡¶ø‡¶ï
    function showUI() {
        document.getElementById('sideToolbar').style.opacity = '1';
        document.getElementById('bottomUI').style.opacity = '1';
        clearTimeout(uiTimer);
        uiTimer = setTimeout(() => {
            if (document.activeElement.tagName !== 'BUTTON' && !document.activeElement.classList.contains('tv-card')) {
                document.getElementById('sideToolbar').style.opacity = '0.2';
                document.getElementById('bottomUI').style.opacity = '0';
            }
        }, 5000);
    }
    document.addEventListener('mousemove', showUI);
    document.addEventListener('keydown', showUI);

    async function init() {
        const res = await fetch(m3uUrl);
        const data = await res.text();
        const lines = data.split('\n');
        for (let i = 0; i < lines.length; i++) {
            if (lines[i].includes('#EXTINF')) {
                channels.push({ name: lines[i].split(',')[1], url: lines[i+1].trim() });
            }
        }
        render();
    }

    function render() {
        tray.innerHTML = '';
        channels.forEach((ch, i) => {
            const card = document.createElement('div');
            card.className = 'tv-card';
            card.tabIndex = 0;
            card.innerText = ch.name;
            card.onclick = () => play(ch.url, ch.name);
            tray.appendChild(card);
        });
        if(channels.length > 0) play(channels[0].url, channels[0].name);
    }

    function play(url, name) {
        document.getElementById('playingNow').innerText = "‡¶è‡¶ñ‡¶® ‡¶ö‡¶≤‡¶õ‡ßá: " + name;
        if (Hls.isSupported()) {
            const hls = new Hls();
            hls.loadSource(url);
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
        }
    }

    function setTimer() {
        const mins = prompt("‡¶ï‡¶§ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶™‡¶∞ ‡¶¨‡¶®‡ßç‡¶ß ‡¶π‡¶¨‡ßá?", "30");
        if(mins) setTimeout(() => { window.close(); document.body.innerHTML = "<h1>TV Sleeping...</h1>"; }, mins * 60000);
    }

    init();
</script>
</body>
</html>
